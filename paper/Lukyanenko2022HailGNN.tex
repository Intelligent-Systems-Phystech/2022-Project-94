\documentclass{article}
\usepackage{arxiv}

\usepackage[utf8]{inputenc}
\usepackage[english]{babel}
\usepackage[T1]{fontenc}
\usepackage{url}
\usepackage{booktabs}
\usepackage{amsfonts}
\usepackage{nicefrac}
\usepackage{microtype}
\usepackage{lipsum}
\usepackage{graphicx}
\usepackage{natbib}
\usepackage{doi}
\usepackage{amsmath}
\usepackage[colorinlistoftodos]{todonotes}
\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator*{\argmin}{arg\,min}
\newcommand\tab[1][0.5cm]{\hspace*{#1}}



\title{Hail risk prediction via Graph Neural Networks}

\author{ Ivan Lukyanenko \\
	Department of Control and Applied Mathematics\\
	Moscow Institute of Physics and Technologies\\
	Moscow \\
	\texttt{lukianenko.ia@phystech.edu} \\
	%% examples of more authors
% 	\And
% 	Yuriy Maximov \\
% 	Research Center in Artificial Intelligence\\
% 	Skoltech\\
	%% \AND
	%% Coauthor \\
	%% Affiliation \\
	%% Address \\
	%% \texttt{email} \\
	%% \And
	%% Coauthor \\
	%% Affiliation \\
	%% Address \\
	%% \texttt{email} \\
	%% \And
	%% Coauthor \\
	%% Affiliation \\
	%% Address \\
	%% \texttt{email} \\
}
\date{}

\renewcommand{\shorttitle}{Hail risk prediction}

%%% Add PDF metadata to help others organize their library
%%% Once the PDF is generated, you can check the metadata with
%%% $ pdfinfo template.pdf
\hypersetup{
pdftitle={Hail risk prediction via Graph Neural Networks},
pdfauthor={Ivan Lukyanenko},
pdfkeywords={Hail risk prediction, GNN},
}

\begin{document}
\fontsize{12}{12pt}\selectfont
\maketitle

\begin{abstract}
	Geo-spatial time series is an open area with great potential for theoretical and practical work. In particular, hail risk assessment is necessary to avoid the damage (agriculture, animal husbandry). The aim of the study is to build a  model based on graph neural networks. Forecasting has been carried out in the short-term range based on the values of climate variables since 1991. The key features of the problem are: 1) rare events - over the past 30 years there have been less than 700 hail events throughout Russia, 2) the spatial structure of the series data. We are expecting to improve quality of solving such problems by combining methods from~\cite{DBLP:journals/corr/abs-2012-01598} and~\cite{DBLP:journals/corr/abs-2005-07427}.
\end{abstract}


\keywords{Hail risk prediction \and GNN \and spatial time series}

\section{Introduction}
The main goal of this research is to introduce new GNN architecture by combining state-of-art results~\cite{DBLP:journals/corr/abs-2012-01598},~\cite{DBLP:journals/corr/abs-2005-07427} in the right way. Our object of research is geo-spatial time series. In common time series is a series of values of a quantity obtained at successive times with equal intervals between them. This research is about more extended concept: spatial time series. Spatial time series are almost the same as ordinary time series, but instead of values we observe some spatial objects. This work provides a solution to the hail forecasting problem. The hails are extreme events, because over the past 30 years there have been less than 700 hail events throughout Russia\todo{add citation}. The assessment of hail risk is necessary because of its environment damage. According to Veriskâ€™s 2021 report~\cite{haillosses}, in 2020 year losses due to hails reached \$14.2 billion in the USA.

The producing architecture is based on works~\cite{DBLP:journals/corr/abs-2012-01598},~\cite{wu2020connecting} and~\cite{DBLP:journals/corr/abs-2005-07427}. ~\cite{DBLP:journals/corr/abs-2005-07427} introduce \textbf{StrGNN} that solves the anomaly detection problem in dynamic graph, this architecture solves big class of problems well, but it should be adapted to narrower tasks. This work produces re-implemented \textbf{StrGNN} for our purpose in combination with GNN-network from~\cite{DBLP:journals/corr/abs-2012-01598}. ~\cite{DBLP:journals/corr/abs-2012-01598} based on the model presented in ~\cite{wu2020connecting}. We are going to use climate data from Google Earth Data, CMIP5, NOAA Storm Events Database, Severe Weather Dataset for training and evaluating our architecture.

\section{Problem Statement}
Using architecture is described in~\cite{DBLP:journals/corr/abs-2005-07427}. This is the parametric family of function to map design space to target space. 
\subsection{StrGNN}
This section describes \textbf{StrGNN} model.\\
Given a temporal network $\{G(t) = \{V(t), E(t)\}^n_{t=1}\}$, where $G(t)$ is the graph snapshot at timestamp $t$ consisting of verticles $V(t)$ and edges $E(t)$.\\
\textbf{StrGNN} works in three stages: ESG, GSFE, TDN.
\subsubsubsection{\textbf{ESG: Enclosing Subgraph Generation}}

The goal is to generate enclosing subgraph structure related to the target edge. Employing the whole graph for analysis is computational expensive. Recent work~\cite{DBLP:journals/corr/abs-1806-03536} proved that in Graph Neural Networks each node is most influenced by its neighbors. Enclosing subgraph in dynamic graphs definition according to \cite{DBLP:journals/corr/abs-2005-07427} is following:\\
\tab Definition 1. (Enclosing subgraph in dynamic graphs) For a temporal network $\{G(i) = \{V(i), E(i)\}\}^t_{i = t-w+1}$ with window size $w$, given a target edge $e^t$ with source node $x^t$ and destination node $y^t$, the $h$--hop enclosing subgraph $G^h_{x^t, y^t}$ centered on edge $e^t$ is a collection of all subgraphs centered on $e^t$ in the temporal network $\{G(i)^h_{x^t, y^t}|(t-w+1)\leq i\leq t \}$. Enclosing subgraph contains only topographical information. In case of this, to distinguish the role of each node, nodes should be labeled. According to \cite{DBLP:journals/corr/abs-2005-07427} good labeling contains the information of 1) target node in subgraph; 2) the contribution of each node in target one.\\
Suggested labeling is following:
\begin{equation}
    f(i,x^t,y^t) = 1 + \min(d(i, x^t), d(i,y^t)) + (d_{\text{sum}}/2)[(d_{\text{sum}/2}) + (d_{\text{sum}}\%2) - 1]
\end{equation}
where $d(i, x^t)$ is the shortest path distance between $i$ and node $x^t$, $d_{\text{sum}} = d(i, x^t) + d(i, y^t)$.\\
If $d(i, x^t) = \infty$ or $d(i, y^t) = \infty$, node $i$ is labeled with 0.
\subsubsubsection{\textbf{GSFE: Graph Structural Feature Extraction}}\\
Graph Convolution Neural Network from \cite{kipf2017semisupervised} map the subgraph space into embedding space.
\subsubsubsection{\textbf{TDN: Temporal Detection Network}}
GSFE generates low-dimensional features, but it does not consider the temporal information to determine the class of the target.\\
Given the extracted feature matrices $\{H_i\}^t_{i = t-w } \ in \mathbb{R}^{K\times d}$, where $K$ is the number of selected nodes in subgraph and $d$ is dimension of feature for each node.\\
Employed the Gated Recurrent Units (GRUs) \cite{DBLP:journals/corr/ChungGCB14} to capture the temporal information as: 
\begin{equation}
    z_t = \sigma(W_zH_t + U_zh_{t-1} + b_z)
\end{equation}
\begin{equation}
    r_t = \sigma(W_rH_t + U_rh_{t-1} + b_r)
\end{equation}
\begin{equation}
    h^{'}_{t} = \text{tanh}(W_hH_t + U_h(r_t \circ h_{t-1}) + b_h)
\end{equation}
\begin{equation}
    h_t = z_t \circ h_{t-1} + (1-z_t) \circ h^{'}_{t}
\end{equation}
where $\circ$ represent the element-wise product, $W$, $U$ and $b$ are parameters. The GRU network is able to model the future temporal information.
\subsection{Loss-function}
The criterion is  log-loss function. Hail Prediction is considering as classification problem. The output of the model is classified months in the prediction horizon whether hail will appear or not.
The problem mathematically summarized as following:
\begin{equation}
    w^* = \argmin\limits_w \Big ( - \frac{1}{N}\sum\limits_{t = 1 }^{N}(y ^ t \log(g(w, h^t)) + (1 - y ^ t)\log(1 - g(w, h^t)))\Big )
\end{equation}
, where  $w^*$ is optimal vector of weights of our architecture; $w$ is vector of weights of our architecture; $t$ is timestamp from the beginning of the prediction horizon; $N$ is number of timestamps in prediction horizon; $y$ is target class of the timestamp; $g$ is fully-connected network; $h$ is output of re-implemented version of \textbf{StrGNN}~\cite{DBLP:journals/corr/abs-2005-07427}\\

\bibliographystyle{abbrv}

\bibliography{references}

\end{document}